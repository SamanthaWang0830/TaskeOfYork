{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useCallback, useRef, useEffect } from \"react\";\nconst useHttpClient = () => {\n  _s();\n  const [isLoading, setIsLoading] = useState(false);\n  const [loadingError, setLoadingError] = useState();\n  const activeHttpRequests = useRef([]);\n  const sendRequest = useCallback(async function (url) {\n    let method = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'GET';\n    let body = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n    let headers = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n    setIsLoading(true);\n    const httpAbortController = new AbortController();\n    activeHttpRequests.current.push(httpAbortController);\n    try {\n      fetch(url, {\n        method,\n        body,\n        headers,\n        signal: httpAbortController.signal\n      });\n      const responseData = await response.json();\n      if (!response.ok) {\n        throw new Error(responseData.message);\n      }\n      return responseData;\n    } catch (err) {\n      setLoadingError(err.message || 'Something went wrong, please try it again');\n    }\n    setIsLoading(false);\n  }, []);\n  const clearError = () => {\n    setLoadingError(null);\n  };\n\n  //a cleanup function\n  useEffect(() => {\n    return () => {\n      activeHttpRequests.current.forEach(abortController => abortController.abort());\n    };\n  }, []);\n  return {\n    isLoading,\n    loadingError,\n    sendRequest,\n    clearError\n  };\n};\n_s(useHttpClient, \"GSWda6DNVWfPF9e+KBEo030mL/c=\");\nexport default useHttpClient;","map":{"version":3,"names":["useState","useCallback","useRef","useEffect","useHttpClient","isLoading","setIsLoading","loadingError","setLoadingError","activeHttpRequests","sendRequest","url","method","body","headers","httpAbortController","AbortController","current","push","fetch","signal","responseData","response","json","ok","Error","message","err","clearError","forEach","abortController","abort"],"sources":["/Users/wzj/前端project/project/tasteofyork/src/hooks/http-hook.jsx"],"sourcesContent":["import { useState,useCallback, useRef , useEffect} from \"react\"\n\nconst useHttpClient=()=>{\n    const [isLoading, setIsLoading]=useState(false)\n    const [loadingError, setLoadingError]=useState()\n\n    const activeHttpRequests= useRef([])\n\n    const sendRequest=useCallback(async(url, method='GET', body=null, headers={})=>{\n        setIsLoading(true)\n        const httpAbortController= new AbortController()\n        activeHttpRequests.current.push(httpAbortController)\n        try {\n            fetch(url,{\n                method,\n                body,\n                headers,\n                signal:httpAbortController.signal\n            })\n            const responseData= await response.json()\n            if(!response.ok){\n                throw new Error(responseData.message)\n            }\n            return responseData\n        } catch (err) {\n            setLoadingError(err.message || 'Something went wrong, please try it again')\n            \n        }\n        setIsLoading(false)\n    },[])\n\n    const clearError=()=>{\n        setLoadingError(null)\n    }\n\n    //a cleanup function\n    useEffect(()=>{\n        return ()=>{\n            activeHttpRequests.current.forEach(abortController=>abortController.abort())\n        }\n    },[])\n    return {isLoading,loadingError,sendRequest,clearError}\n}\nexport default useHttpClient"],"mappings":";AAAA,SAASA,QAAQ,EAACC,WAAW,EAAEC,MAAM,EAAGC,SAAS,QAAO,OAAO;AAE/D,MAAMC,aAAa,GAAC,MAAI;EAAA;EACpB,MAAM,CAACC,SAAS,EAAEC,YAAY,CAAC,GAACN,QAAQ,CAAC,KAAK,CAAC;EAC/C,MAAM,CAACO,YAAY,EAAEC,eAAe,CAAC,GAACR,QAAQ,EAAE;EAEhD,MAAMS,kBAAkB,GAAEP,MAAM,CAAC,EAAE,CAAC;EAEpC,MAAMQ,WAAW,GAACT,WAAW,CAAC,gBAAMU,GAAG,EAAwC;IAAA,IAAtCC,MAAM,uEAAC,KAAK;IAAA,IAAEC,IAAI,uEAAC,IAAI;IAAA,IAAEC,OAAO,uEAAC,CAAC,CAAC;IACxER,YAAY,CAAC,IAAI,CAAC;IAClB,MAAMS,mBAAmB,GAAE,IAAIC,eAAe,EAAE;IAChDP,kBAAkB,CAACQ,OAAO,CAACC,IAAI,CAACH,mBAAmB,CAAC;IACpD,IAAI;MACAI,KAAK,CAACR,GAAG,EAAC;QACNC,MAAM;QACNC,IAAI;QACJC,OAAO;QACPM,MAAM,EAACL,mBAAmB,CAACK;MAC/B,CAAC,CAAC;MACF,MAAMC,YAAY,GAAE,MAAMC,QAAQ,CAACC,IAAI,EAAE;MACzC,IAAG,CAACD,QAAQ,CAACE,EAAE,EAAC;QACZ,MAAM,IAAIC,KAAK,CAACJ,YAAY,CAACK,OAAO,CAAC;MACzC;MACA,OAAOL,YAAY;IACvB,CAAC,CAAC,OAAOM,GAAG,EAAE;MACVnB,eAAe,CAACmB,GAAG,CAACD,OAAO,IAAI,2CAA2C,CAAC;IAE/E;IACApB,YAAY,CAAC,KAAK,CAAC;EACvB,CAAC,EAAC,EAAE,CAAC;EAEL,MAAMsB,UAAU,GAAC,MAAI;IACjBpB,eAAe,CAAC,IAAI,CAAC;EACzB,CAAC;;EAED;EACAL,SAAS,CAAC,MAAI;IACV,OAAO,MAAI;MACPM,kBAAkB,CAACQ,OAAO,CAACY,OAAO,CAACC,eAAe,IAAEA,eAAe,CAACC,KAAK,EAAE,CAAC;IAChF,CAAC;EACL,CAAC,EAAC,EAAE,CAAC;EACL,OAAO;IAAC1B,SAAS;IAACE,YAAY;IAACG,WAAW;IAACkB;EAAU,CAAC;AAC1D,CAAC;AAAA,GAxCKxB,aAAa;AAyCnB,eAAeA,aAAa"},"metadata":{},"sourceType":"module","externalDependencies":[]}